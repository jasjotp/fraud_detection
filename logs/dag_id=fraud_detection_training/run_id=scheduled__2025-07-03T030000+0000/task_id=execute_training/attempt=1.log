[2025-07-04T03:00:06.803+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-07-04T03:00:06.836+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fraud_detection_training.execute_training scheduled__2025-07-03T03:00:00+00:00 [queued]>
[2025-07-04T03:00:06.851+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fraud_detection_training.execute_training scheduled__2025-07-03T03:00:00+00:00 [queued]>
[2025-07-04T03:00:06.853+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1
[2025-07-04T03:00:06.875+0000] {taskinstance.py:2890} INFO - Executing <Task(PythonOperator): execute_training> on 2025-07-03 03:00:00+00:00
[2025-07-04T03:00:06.886+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1327) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-07-04T03:00:06.889+0000] {standard_task_runner.py:72} INFO - Started process 1328 to run task
[2025-07-04T03:00:06.889+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'fraud_detection_training', 'execute_training', 'scheduled__2025-07-03T03:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/fraud_detection_training_dag.py', '--cfg-path', '/tmp/tmp6p3orczi']
[2025-07-04T03:00:06.891+0000] {standard_task_runner.py:105} INFO - Job 13: Subtask execute_training
[2025-07-04T03:00:06.958+0000] {task_command.py:467} INFO - Running <TaskInstance: fraud_detection_training.execute_training scheduled__2025-07-03T03:00:00+00:00 [running]> on host 8862b69bc4b5
[2025-07-04T03:00:07.087+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Jasjot Parmar' AIRFLOW_CTX_DAG_ID='fraud_detection_training' AIRFLOW_CTX_TASK_ID='execute_training' AIRFLOW_CTX_EXECUTION_DATE='2025-07-03T03:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-03T03:00:00+00:00'
[2025-07-04T03:00:07.089+0000] {taskinstance.py:732} INFO - ::endgroup::
[2025-07-04T03:00:07.120+0000] {fraud_detection_training_dag.py:23} INFO - Initializing fraud detection training...
[2025-07-04T03:00:16.605+0000] {fraud_detection_training_dag.py:26} INFO - Imported FraudDetectionTraining successfully.
[2025-07-04T03:00:16.630+0000] {fraud_detection_training.py:75} INFO - Configuration loaded successfully
[2025-07-04T03:00:17.375+0000] {fraud_detection_training.py:106} INFO - Minio connection verified. Buckets: ['mlflow']
[2025-07-04T03:00:19.404+0000] {fraud_detection_training_dag.py:29} INFO - Trainer initialized successfully.
[2025-07-04T03:00:19.405+0000] {fraud_detection_training.py:429} INFO - Starting model training process...
[2025-07-04T03:00:19.405+0000] {fraud_detection_training.py:122} INFO - Connecting to Kafka Topic: transactions
[2025-07-04T03:00:19.524+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connecting> [IPv4 ('15.157.158.196', 9092)]>: connecting to pkc-ld537.ca-central-1.aws.confluent.cloud:9092 [('15.157.158.196', 9092) IPv4]
[2025-07-04T03:00:19.608+0000] {conn.py:497} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <handshake> [IPv4 ('15.157.158.196', 9092)]>: Loading system default SSL CAs from ('/usr/lib/ssl/cert.pem', '/usr/lib/ssl/certs', 'SSL_CERT_FILE', '/usr/lib/ssl/cert.pem', 'SSL_CERT_DIR', '/usr/lib/ssl/certs')
[2025-07-04T03:00:19.918+0000] {conn.py:618} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <checking_api_versions_recv> [IPv4 ('15.157.158.196', 9092)]>: Broker version identified as 2.6
[2025-07-04T03:00:20.165+0000] {conn.py:822} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <authenticating> [IPv4 ('15.157.158.196', 9092)]>: Authenticated as VAWD3ORVNJTGIOBA via SASL / Plain
[2025-07-04T03:00:20.166+0000] {conn.py:467} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>: Connection complete.
[2025-07-04T03:00:20.168+0000] {consumer.py:120} WARNING - group_id is None: disabling auto-commit.
[2025-07-04T03:00:20.169+0000] {subscription_state.py:181} INFO - Updating subscribed topics to: ('transactions',)
[2025-07-04T03:00:20.242+0000] {subscription_state.py:254} INFO - Updated partition assignment: [('transactions', 0), ('transactions', 1), ('transactions', 2), ('transactions', 3), ('transactions', 4), ('transactions', 5)]
[2025-07-04T03:00:20.293+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=b1-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connecting> [IPv4 ('35.182.170.137', 9092)]>: connecting to b1-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 [('35.182.170.137', 9092) IPv4]
[2025-07-04T03:00:20.338+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=2 host=b2-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connecting> [IPv4 ('15.157.158.196', 9092)]>: connecting to b2-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 [('15.157.158.196', 9092) IPv4]
[2025-07-04T03:00:20.388+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=3 host=b3-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connecting> [IPv4 ('15.223.160.19', 9092)]>: connecting to b3-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 [('15.223.160.19', 9092) IPv4]
[2025-07-04T03:00:20.426+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=5 host=b5-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connecting> [IPv4 ('15.157.158.196', 9092)]>: connecting to b5-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 [('15.157.158.196', 9092) IPv4]
[2025-07-04T03:00:20.465+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=6 host=b6-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connecting> [IPv4 ('15.223.160.19', 9092)]>: connecting to b6-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 [('15.223.160.19', 9092) IPv4]
[2025-07-04T03:00:20.502+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=7 host=b7-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connecting> [IPv4 ('35.182.170.137', 9092)]>: connecting to b7-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 [('35.182.170.137', 9092) IPv4]
[2025-07-04T03:00:20.504+0000] {conn.py:497} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=b1-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <handshake> [IPv4 ('35.182.170.137', 9092)]>: Loading system default SSL CAs from ('/usr/lib/ssl/cert.pem', '/usr/lib/ssl/certs', 'SSL_CERT_FILE', '/usr/lib/ssl/cert.pem', 'SSL_CERT_DIR', '/usr/lib/ssl/certs')
[2025-07-04T03:00:20.535+0000] {conn.py:497} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=2 host=b2-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <handshake> [IPv4 ('15.157.158.196', 9092)]>: Loading system default SSL CAs from ('/usr/lib/ssl/cert.pem', '/usr/lib/ssl/certs', 'SSL_CERT_FILE', '/usr/lib/ssl/cert.pem', 'SSL_CERT_DIR', '/usr/lib/ssl/certs')
[2025-07-04T03:00:20.568+0000] {conn.py:497} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=3 host=b3-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <handshake> [IPv4 ('15.223.160.19', 9092)]>: Loading system default SSL CAs from ('/usr/lib/ssl/cert.pem', '/usr/lib/ssl/certs', 'SSL_CERT_FILE', '/usr/lib/ssl/cert.pem', 'SSL_CERT_DIR', '/usr/lib/ssl/certs')
[2025-07-04T03:00:20.605+0000] {conn.py:497} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=5 host=b5-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <handshake> [IPv4 ('15.157.158.196', 9092)]>: Loading system default SSL CAs from ('/usr/lib/ssl/cert.pem', '/usr/lib/ssl/certs', 'SSL_CERT_FILE', '/usr/lib/ssl/cert.pem', 'SSL_CERT_DIR', '/usr/lib/ssl/certs')
[2025-07-04T03:00:20.643+0000] {conn.py:497} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=6 host=b6-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <handshake> [IPv4 ('15.223.160.19', 9092)]>: Loading system default SSL CAs from ('/usr/lib/ssl/cert.pem', '/usr/lib/ssl/certs', 'SSL_CERT_FILE', '/usr/lib/ssl/cert.pem', 'SSL_CERT_DIR', '/usr/lib/ssl/certs')
[2025-07-04T03:00:20.679+0000] {conn.py:497} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=7 host=b7-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <handshake> [IPv4 ('35.182.170.137', 9092)]>: Loading system default SSL CAs from ('/usr/lib/ssl/cert.pem', '/usr/lib/ssl/certs', 'SSL_CERT_FILE', '/usr/lib/ssl/cert.pem', 'SSL_CERT_DIR', '/usr/lib/ssl/certs')
[2025-07-04T03:00:20.967+0000] {conn.py:822} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=b1-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <authenticating> [IPv4 ('35.182.170.137', 9092)]>: Authenticated as VAWD3ORVNJTGIOBA via SASL / Plain
[2025-07-04T03:00:20.968+0000] {conn.py:467} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=b1-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('35.182.170.137', 9092)]>: Connection complete.
[2025-07-04T03:00:20.969+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>: Closing connection. 
[2025-07-04T03:00:21.047+0000] {conn.py:822} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=2 host=b2-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <authenticating> [IPv4 ('15.157.158.196', 9092)]>: Authenticated as VAWD3ORVNJTGIOBA via SASL / Plain
[2025-07-04T03:00:21.049+0000] {conn.py:467} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=2 host=b2-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>: Connection complete.
[2025-07-04T03:00:21.230+0000] {conn.py:822} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=3 host=b3-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <authenticating> [IPv4 ('15.223.160.19', 9092)]>: Authenticated as VAWD3ORVNJTGIOBA via SASL / Plain
[2025-07-04T03:00:21.232+0000] {conn.py:467} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=3 host=b3-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.223.160.19', 9092)]>: Connection complete.
[2025-07-04T03:00:21.406+0000] {conn.py:822} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=5 host=b5-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <authenticating> [IPv4 ('15.157.158.196', 9092)]>: Authenticated as VAWD3ORVNJTGIOBA via SASL / Plain
[2025-07-04T03:00:21.408+0000] {conn.py:467} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=5 host=b5-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>: Connection complete.
[2025-07-04T03:00:21.580+0000] {conn.py:822} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=6 host=b6-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <authenticating> [IPv4 ('15.223.160.19', 9092)]>: Authenticated as VAWD3ORVNJTGIOBA via SASL / Plain
[2025-07-04T03:00:21.581+0000] {conn.py:467} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=6 host=b6-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.223.160.19', 9092)]>: Connection complete.
[2025-07-04T03:00:21.754+0000] {conn.py:822} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=7 host=b7-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <authenticating> [IPv4 ('35.182.170.137', 9092)]>: Authenticated as VAWD3ORVNJTGIOBA via SASL / Plain
[2025-07-04T03:00:21.755+0000] {conn.py:467} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=7 host=b7-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('35.182.170.137', 9092)]>: Connection complete.
[2025-07-04T03:00:21.756+0000] {fetcher.py:418} INFO - Resetting offset for partition ('transactions', 1) to offset 35606.
[2025-07-04T03:00:21.760+0000] {fetcher.py:418} INFO - Resetting offset for partition ('transactions', 5) to offset 35540.
[2025-07-04T03:00:21.761+0000] {fetcher.py:418} INFO - Resetting offset for partition ('transactions', 3) to offset 35323.
[2025-07-04T03:00:21.830+0000] {fetcher.py:418} INFO - Resetting offset for partition ('transactions', 4) to offset 35328.
[2025-07-04T03:00:21.831+0000] {fetcher.py:418} INFO - Resetting offset for partition ('transactions', 0) to offset 35634.
[2025-07-04T03:00:21.834+0000] {fetcher.py:418} INFO - Resetting offset for partition ('transactions', 2) to offset 35856.
[2025-07-04T03:10:20.380+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=8 host=b8-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connecting> [IPv4 ('15.157.158.196', 9092)]>: connecting to b8-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 [('15.157.158.196', 9092) IPv4]
[2025-07-04T03:10:20.455+0000] {conn.py:497} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=8 host=b8-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <handshake> [IPv4 ('15.157.158.196', 9092)]>: Loading system default SSL CAs from ('/usr/lib/ssl/cert.pem', '/usr/lib/ssl/certs', 'SSL_CERT_FILE', '/usr/lib/ssl/cert.pem', 'SSL_CERT_DIR', '/usr/lib/ssl/certs')
[2025-07-04T03:10:20.897+0000] {conn.py:822} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=8 host=b8-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <authenticating> [IPv4 ('15.157.158.196', 9092)]>: Authenticated as VAWD3ORVNJTGIOBA via SASL / Plain
[2025-07-04T03:10:20.899+0000] {conn.py:467} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=8 host=b8-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>: Connection complete.
[2025-07-04T03:10:39.524+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=b1-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('35.182.170.137', 9092)]>: Closing connection. 
[2025-07-04T03:10:39.534+0000] {fetcher.py:786} INFO - Fetch to node 1 failed: Cancelled: <BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=b1-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('35.182.170.137', 9092)]>
[2025-07-04T03:10:39.536+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=2 host=b2-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>: Closing connection. 
[2025-07-04T03:10:39.537+0000] {fetcher.py:786} INFO - Fetch to node 2 failed: Cancelled: <BrokerConnection client_id=kafka-python-2.2.15, node_id=2 host=b2-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>
[2025-07-04T03:10:39.539+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=3 host=b3-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.223.160.19', 9092)]>: Closing connection. 
[2025-07-04T03:10:39.540+0000] {fetcher.py:786} INFO - Fetch to node 3 failed: Cancelled: <BrokerConnection client_id=kafka-python-2.2.15, node_id=3 host=b3-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.223.160.19', 9092)]>
[2025-07-04T03:10:39.541+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=5 host=b5-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>: Closing connection. 
[2025-07-04T03:10:39.543+0000] {fetcher.py:786} INFO - Fetch to node 5 failed: Cancelled: <BrokerConnection client_id=kafka-python-2.2.15, node_id=5 host=b5-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>
[2025-07-04T03:10:39.544+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=6 host=b6-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.223.160.19', 9092)]>: Closing connection. 
[2025-07-04T03:10:39.547+0000] {fetcher.py:786} INFO - Fetch to node 6 failed: Cancelled: <BrokerConnection client_id=kafka-python-2.2.15, node_id=6 host=b6-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.223.160.19', 9092)]>
[2025-07-04T03:10:39.548+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=7 host=b7-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('35.182.170.137', 9092)]>: Closing connection. 
[2025-07-04T03:10:39.550+0000] {fetcher.py:786} INFO - Fetch to node 7 failed: Cancelled: <BrokerConnection client_id=kafka-python-2.2.15, node_id=7 host=b7-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('35.182.170.137', 9092)]>
[2025-07-04T03:10:39.553+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-2.2.15, node_id=8 host=b8-pkc-ld537.ca-central-1.aws.confluent.cloud:9092 <connected> [IPv4 ('15.157.158.196', 9092)]>: Closing connection. 
[2025-07-04T03:10:40.198+0000] {fraud_detection_training.py:155} INFO - Kafka data read successfully with fraud rate: 0.44
[2025-07-04T03:11:39.653+0000] {logging_mixin.py:190} INFO - 0 rows have NaNs
[2025-07-04T03:11:39.658+0000] {logging_mixin.py:190} INFO - Empty DataFrame
Columns: [amount, is_night, is_weekend, transaction_day, user_activity_24h, amount_to_avg_ratio, merchant_risk, merchant, transaction_hour, transaction_hour_sin, transaction_hour_cos, transaction_dayOfWeek, user_transactions_per_minute, is_high_velocity, days_since_last_transaction, is_unusual_hour_for_user, time_diff, user_avg_transaction_interval, zscore_amount_per_user, burst_small_txn_count_last_min, txn_count_last_5min, user_transaction_amount_std, amount_7d_avg, amount_to_avg_ratio_7d, amount_vs_median, user_total_spend_todate, amount_spent_last24h, user_spending_ratio_last24h, prev_amount, amount_change_ratio, user_merchant_transaction_count, num_distinct_merchants_24h, merchant_avg_fraud_rate, is_location_anomalous, is_location_mismatch]
Index: []
[2025-07-04T03:11:39.673+0000] {fraud_detection_training.py:449} INFO - Columns with NaNs: []
[2025-07-04T03:11:40.408+0000] {logging_mixin.py:190} WARNING - [I 2025-07-04 03:11:40,408] A new study created in memory with name: no-name-3f87e1e6-ecf5-45e2-8be8-9161b0c4842a
[2025-07-04T03:11:40.409+0000] {fraud_detection_training.py:591} INFO - Starting Optuna hyperparameter optimization...
[2025-07-04T03:11:40.411+0000] {logging_mixin.py:190} WARNING -   0%|          | 0/20 [00:00<?, ?it/s]
[2025-07-04T03:11:40.435+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:11:56.735+0000] {logging_mixin.py:190} WARNING -                                       
[2025-07-04T03:11:56.736+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:11:56.737+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:11:56,735] Trial 0 finished with value: 0.43121720598870583 and parameters: {'use_amount': False, 'use_is_night': False, 'use_is_weekend': False, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': False, 'use_user_activity_24h': False, 'use_txn_per_min': True, 'use_is_high_velocity': False, 'use_txn_count_5min': True, 'use_amt_to_avg_ratio': True, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': False, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': True, 'use_txn_hour_sin': False, 'use_txn_hour_cos': False, 'use_day_of_week': False, 'use_days_since_last': False, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': False, 'use_zscore_amt': True, 'use_burst_small_txn': True, 'use_txn_amt_std': False, 'use_amt_7d_avg': True, 'use_total_spend': True, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': True, 'use_merchant_txn_cnt': False, 'use_merchant_dist_24h': True, 'use_loc_anomalous': True, 'use_loc_mismatch': False, 'max_depth': 5, 'learning_rate': 0.06051539106667653, 'subsample': 0.6319996225126877, 'colsample_bytree': 0.9222459829914982, 'gamma': 0.2543419329598918, 'reg_alpha': 0.023691648762086848}. Best is trial 0 with value: 0.43121720598870583.
[2025-07-04T03:11:56.737+0000] {logging_mixin.py:190} WARNING -   0%|          | 0/20 [00:16<?, ?it/s]
[2025-07-04T03:11:56.742+0000] {logging_mixin.py:190} WARNING - Best trial: 0. Best value: 0.431217:   0%|          | 0/20 [00:16<?, ?it/s]
[2025-07-04T03:11:56.743+0000] {logging_mixin.py:190} WARNING - Best trial: 0. Best value: 0.431217:   5%|5         | 1/20 [00:16<05:10, 16.33s/it]
[2025-07-04T03:11:56.761+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:12:02.918+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:12:02.919+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:12:02.920+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:12:02,918] Trial 1 finished with value: 0.433912142668625 and parameters: {'use_amount': False, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': False, 'use_amount_spent_last24h': True, 'use_prev_amount': False, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': True, 'use_txn_hour': False, 'use_txn_hour_sin': True, 'use_txn_hour_cos': True, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': False, 'use_avg_txn_interval': True, 'use_zscore_amt': True, 'use_burst_small_txn': False, 'use_txn_amt_std': False, 'use_amt_7d_avg': False, 'use_total_spend': False, 'use_merchant_risk': True, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': False, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': True, 'max_depth': 4, 'learning_rate': 0.07288609064155378, 'subsample': 0.7388752971925777, 'colsample_bytree': 0.6821815259588286, 'gamma': 0.05080514528390307, 'reg_alpha': 0.049252387709956436}. Best is trial 1 with value: 0.433912142668625.
[2025-07-04T03:12:02.921+0000] {logging_mixin.py:190} WARNING - Best trial: 0. Best value: 0.431217:   5%|5         | 1/20 [00:22<05:10, 16.33s/it]
[2025-07-04T03:12:02.925+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:   5%|5         | 1/20 [00:22<05:10, 16.33s/it]
[2025-07-04T03:12:02.926+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:  10%|#         | 2/20 [00:22<03:06, 10.36s/it]
[2025-07-04T03:12:02.945+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:12:08.438+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:12:08.439+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:12:08.440+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:12:08,438] Trial 2 finished with value: 0.2434067587323503 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': False, 'use_transaction_day': True, 'use_amount_spent_last24h': True, 'use_prev_amount': False, 'use_user_activity_24h': False, 'use_txn_per_min': False, 'use_is_high_velocity': True, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': True, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': False, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': True, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': False, 'use_avg_txn_interval': True, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': False, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': True, 'use_merchant_txn_cnt': False, 'use_merchant_dist_24h': True, 'use_loc_anomalous': True, 'use_loc_mismatch': False, 'max_depth': 3, 'learning_rate': 0.015372101822157213, 'subsample': 0.8831937338723054, 'colsample_bytree': 0.8895606653042658, 'gamma': 0.2456273577611719, 'reg_alpha': 0.4312706582964218}. Best is trial 1 with value: 0.433912142668625.
[2025-07-04T03:12:08.440+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:  10%|#         | 2/20 [00:28<03:06, 10.36s/it]
[2025-07-04T03:12:08.445+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:  10%|#         | 2/20 [00:28<03:06, 10.36s/it]
[2025-07-04T03:12:08.446+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:  15%|#5        | 3/20 [00:28<02:18,  8.15s/it]
[2025-07-04T03:12:08.463+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:12:22.424+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:12:22.424+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:12:22.425+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:12:22,423] Trial 3 finished with value: 0.42114462735956276 and parameters: {'use_amount': True, 'use_is_night': True, 'use_is_weekend': False, 'use_transaction_day': True, 'use_amount_spent_last24h': True, 'use_prev_amount': False, 'use_user_activity_24h': False, 'use_txn_per_min': True, 'use_is_high_velocity': False, 'use_txn_count_5min': True, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': True, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': True, 'use_txn_hour_sin': True, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': False, 'use_avg_txn_interval': True, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': True, 'use_total_spend': True, 'use_merchant_risk': False, 'use_merchant': True, 'use_merchant_avg_fraud': True, 'use_merchant_txn_cnt': False, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': False, 'max_depth': 6, 'learning_rate': 0.027337282065972933, 'subsample': 0.7060516755685, 'colsample_bytree': 0.7870252278694917, 'gamma': 0.23385282559431966, 'reg_alpha': 0.467639063637508}. Best is trial 1 with value: 0.433912142668625.
[2025-07-04T03:12:22.426+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:  15%|#5        | 3/20 [00:42<02:18,  8.15s/it]
[2025-07-04T03:12:22.432+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:  15%|#5        | 3/20 [00:42<02:18,  8.15s/it]
[2025-07-04T03:12:22.433+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:  20%|##        | 4/20 [00:42<02:47, 10.45s/it]
[2025-07-04T03:12:22.454+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:12:32.501+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:12:32.501+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:12:32.502+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:12:32,500] Trial 4 finished with value: 0.44379605577479353 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': False, 'use_amount_spent_last24h': False, 'use_prev_amount': False, 'use_user_activity_24h': False, 'use_txn_per_min': False, 'use_is_high_velocity': True, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': True, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': False, 'use_txn_hour_cos': True, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': True, 'use_zscore_amt': True, 'use_burst_small_txn': False, 'use_txn_amt_std': False, 'use_amt_7d_avg': False, 'use_total_spend': False, 'use_merchant_risk': False, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': True, 'max_depth': 5, 'learning_rate': 0.06855763790807624, 'subsample': 0.8024009299360907, 'colsample_bytree': 0.9091716001908969, 'gamma': 0.17650051611312625, 'reg_alpha': 0.0620740727203809}. Best is trial 4 with value: 0.44379605577479353.
[2025-07-04T03:12:32.502+0000] {logging_mixin.py:190} WARNING - Best trial: 1. Best value: 0.433912:  20%|##        | 4/20 [00:52<02:47, 10.45s/it]
[2025-07-04T03:12:32.507+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  20%|##        | 4/20 [00:52<02:47, 10.45s/it]
[2025-07-04T03:12:32.508+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  25%|##5       | 5/20 [00:52<02:34, 10.32s/it]
[2025-07-04T03:12:32.525+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:12:38.819+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:12:38.819+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:12:38.820+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:12:38,818] Trial 5 finished with value: 0.3934804005415544 and parameters: {'use_amount': True, 'use_is_night': True, 'use_is_weekend': False, 'use_transaction_day': False, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': False, 'use_txn_per_min': False, 'use_is_high_velocity': True, 'use_txn_count_5min': True, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': True, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': True, 'use_txn_hour_sin': True, 'use_txn_hour_cos': True, 'use_day_of_week': True, 'use_days_since_last': False, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': True, 'use_zscore_amt': False, 'use_burst_small_txn': True, 'use_txn_amt_std': False, 'use_amt_7d_avg': False, 'use_total_spend': False, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': False, 'use_loc_anomalous': False, 'use_loc_mismatch': True, 'max_depth': 4, 'learning_rate': 0.03525430369435281, 'subsample': 0.9097932517768258, 'colsample_bytree': 0.9902430437554682, 'gamma': 0.203185938764017, 'reg_alpha': 0.21023964912107623}. Best is trial 4 with value: 0.44379605577479353.
[2025-07-04T03:12:38.821+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  25%|##5       | 5/20 [00:58<02:34, 10.32s/it]
[2025-07-04T03:12:38.826+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  25%|##5       | 5/20 [00:58<02:34, 10.32s/it]
[2025-07-04T03:12:38.826+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  30%|###       | 6/20 [00:58<02:05,  8.96s/it]
[2025-07-04T03:12:38.852+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:12:49.295+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:12:49.296+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:12:49.296+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:12:49,294] Trial 6 finished with value: 0.39709735067037916 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': False, 'use_transaction_day': False, 'use_amount_spent_last24h': False, 'use_prev_amount': False, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': True, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': True, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': True, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': True, 'use_txn_hour_cos': True, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': False, 'use_time_diff': True, 'use_avg_txn_interval': True, 'use_zscore_amt': True, 'use_burst_small_txn': False, 'use_txn_amt_std': False, 'use_amt_7d_avg': True, 'use_total_spend': False, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': True, 'use_merchant_txn_cnt': False, 'use_merchant_dist_24h': True, 'use_loc_anomalous': False, 'use_loc_mismatch': False, 'max_depth': 7, 'learning_rate': 0.01671772075949915, 'subsample': 0.9645462448855129, 'colsample_bytree': 0.7750607796690477, 'gamma': 0.07640772098195033, 'reg_alpha': 0.36832886732232684}. Best is trial 4 with value: 0.44379605577479353.
[2025-07-04T03:12:49.297+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  30%|###       | 6/20 [01:08<02:05,  8.96s/it]
[2025-07-04T03:12:49.302+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  30%|###       | 6/20 [01:08<02:05,  8.96s/it]
[2025-07-04T03:12:49.303+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  35%|###5      | 7/20 [01:08<02:02,  9.45s/it]
[2025-07-04T03:12:49.331+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:13:07.061+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:13:07.062+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:13:07.063+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:13:07,061] Trial 7 finished with value: 0.4147035415478446 and parameters: {'use_amount': False, 'use_is_night': True, 'use_is_weekend': True, 'use_transaction_day': False, 'use_amount_spent_last24h': True, 'use_prev_amount': True, 'use_user_activity_24h': False, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': True, 'use_amt_to_avg_ratio': True, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': True, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': True, 'use_txn_hour_cos': True, 'use_day_of_week': True, 'use_days_since_last': False, 'use_unusual_hour_flag': False, 'use_time_diff': False, 'use_avg_txn_interval': False, 'use_zscore_amt': True, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': True, 'use_total_spend': True, 'use_merchant_risk': False, 'use_merchant': False, 'use_merchant_avg_fraud': True, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': True, 'max_depth': 7, 'learning_rate': 0.02109704547374405, 'subsample': 0.9073628361488639, 'colsample_bytree': 0.8521726828409322, 'gamma': 0.17190203920522296, 'reg_alpha': 0.4156896903154852}. Best is trial 4 with value: 0.44379605577479353.
[2025-07-04T03:13:07.064+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  35%|###5      | 7/20 [01:26<02:02,  9.45s/it]
[2025-07-04T03:13:07.068+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  35%|###5      | 7/20 [01:26<02:02,  9.45s/it]
[2025-07-04T03:13:07.069+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  40%|####      | 8/20 [01:26<02:25, 12.10s/it]
[2025-07-04T03:13:07.108+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:13:13.786+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:13:13.787+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:13:13.787+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:13:13,786] Trial 8 finished with value: 0.45252914866381144 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': False, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': True, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': False, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': True, 'use_loc_anomalous': True, 'use_loc_mismatch': False, 'max_depth': 6, 'learning_rate': 0.05512734618003183, 'subsample': 0.9340936881905932, 'colsample_bytree': 0.934429833985923, 'gamma': 0.29479564384858875, 'reg_alpha': 0.3857938418193542}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:13:13.788+0000] {logging_mixin.py:190} WARNING - Best trial: 4. Best value: 0.443796:  40%|####      | 8/20 [01:33<02:25, 12.10s/it]
[2025-07-04T03:13:13.793+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  40%|####      | 8/20 [01:33<02:25, 12.10s/it]
[2025-07-04T03:13:13.793+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  45%|####5     | 9/20 [01:33<01:54, 10.42s/it]
[2025-07-04T03:13:13.811+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:13:20.607+0000] {logging_mixin.py:190} WARNING -                                                                                    
[2025-07-04T03:13:20.607+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:13:20.608+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:13:20,606] Trial 9 finished with value: 0.36203165898043127 and parameters: {'use_amount': True, 'use_is_night': True, 'use_is_weekend': False, 'use_transaction_day': True, 'use_amount_spent_last24h': True, 'use_prev_amount': False, 'use_user_activity_24h': False, 'use_txn_per_min': False, 'use_is_high_velocity': True, 'use_txn_count_5min': True, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': False, 'use_txn_hour': True, 'use_txn_hour_sin': True, 'use_txn_hour_cos': False, 'use_day_of_week': False, 'use_days_since_last': False, 'use_unusual_hour_flag': True, 'use_time_diff': False, 'use_avg_txn_interval': True, 'use_zscore_amt': True, 'use_burst_small_txn': False, 'use_txn_amt_std': False, 'use_amt_7d_avg': False, 'use_total_spend': False, 'use_merchant_risk': False, 'use_merchant': True, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': True, 'use_loc_anomalous': False, 'use_loc_mismatch': False, 'max_depth': 5, 'learning_rate': 0.01263730284296452, 'subsample': 0.7512598875705594, 'colsample_bytree': 0.7249652387059224, 'gamma': 0.2404906433011956, 'reg_alpha': 0.28598520469933136}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:13:20.609+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  45%|####5     | 9/20 [01:40<01:54, 10.42s/it]
[2025-07-04T03:13:20.613+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  45%|####5     | 9/20 [01:40<01:54, 10.42s/it]
[2025-07-04T03:13:20.614+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  50%|#####     | 10/20 [01:40<01:33,  9.31s/it]
[2025-07-04T03:13:20.697+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:13:28.076+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:13:28.077+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:13:28.077+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:13:28,075] Trial 10 finished with value: 0.4295545344103528 and parameters: {'use_amount': False, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': True, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': True, 'use_txn_hour': False, 'use_txn_hour_sin': False, 'use_txn_hour_cos': False, 'use_day_of_week': False, 'use_days_since_last': True, 'use_unusual_hour_flag': False, 'use_time_diff': False, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': True, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': True, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': True, 'use_loc_anomalous': False, 'use_loc_mismatch': False, 'max_depth': 6, 'learning_rate': 0.04437643382900563, 'subsample': 0.8376048926341764, 'colsample_bytree': 0.6157761070418298, 'gamma': 0.11763485016611103, 'reg_alpha': 0.20639883962163744}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:13:28.078+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  50%|#####     | 10/20 [01:47<01:33,  9.31s/it]
[2025-07-04T03:13:28.082+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  50%|#####     | 10/20 [01:47<01:33,  9.31s/it]
[2025-07-04T03:13:28.083+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  55%|#####5    | 11/20 [01:47<01:18,  8.75s/it]
[2025-07-04T03:13:28.154+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:13:43.723+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:13:43.724+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:13:43.725+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:13:43,723] Trial 11 finished with value: 0.4407152316297034 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': False, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': True, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': True, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': True, 'use_txn_hour': False, 'use_txn_hour_sin': False, 'use_txn_hour_cos': True, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': False, 'use_merchant_risk': False, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': True, 'max_depth': 6, 'learning_rate': 0.09857969942834448, 'subsample': 0.9970440861624423, 'colsample_bytree': 0.9951043429922748, 'gamma': 0.28880761343556144, 'reg_alpha': 0.10293981118001971}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:13:43.725+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  55%|#####5    | 11/20 [02:03<01:18,  8.75s/it]
[2025-07-04T03:13:43.730+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  55%|#####5    | 11/20 [02:03<01:18,  8.75s/it]
[2025-07-04T03:13:43.731+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  60%|######    | 12/20 [02:03<01:26, 10.85s/it]
[2025-07-04T03:13:43.803+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:13:50.846+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:13:50.847+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:13:50.847+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:13:50,845] Trial 12 finished with value: 0.428585726160353 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': True, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': False, 'use_txn_hour_cos': True, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': False, 'use_zscore_amt': True, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': False, 'use_merchant_risk': False, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': True, 'use_loc_anomalous': True, 'use_loc_mismatch': True, 'max_depth': 5, 'learning_rate': 0.05374577648857893, 'subsample': 0.8046475286209805, 'colsample_bytree': 0.9175101143705534, 'gamma': 0.14065317100808924, 'reg_alpha': 0.31436669645047055}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:13:50.848+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  60%|######    | 12/20 [02:10<01:26, 10.85s/it]
[2025-07-04T03:13:50.853+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  60%|######    | 12/20 [02:10<01:26, 10.85s/it]
[2025-07-04T03:13:50.854+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  65%|######5   | 13/20 [02:10<01:08,  9.72s/it]
[2025-07-04T03:13:50.924+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:13:57.331+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:13:57.331+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:13:57.332+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:13:57,330] Trial 13 finished with value: 0.43125020193208613 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': False, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': True, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': False, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': False, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': True, 'max_depth': 4, 'learning_rate': 0.09251723395928202, 'subsample': 0.8475762967909676, 'colsample_bytree': 0.8459744871434812, 'gamma': 0.015218358524261982, 'reg_alpha': 0.13359085685048516}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:13:57.333+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  65%|######5   | 13/20 [02:16<01:08,  9.72s/it]
[2025-07-04T03:13:57.338+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  65%|######5   | 13/20 [02:16<01:08,  9.72s/it]
[2025-07-04T03:13:57.339+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  70%|#######   | 14/20 [02:16<00:52,  8.74s/it]
[2025-07-04T03:13:57.417+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:14:13.790+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:14:13.790+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:14:13.791+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:14:13,789] Trial 14 finished with value: 0.43926325000533567 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': False, 'use_user_activity_24h': False, 'use_txn_per_min': True, 'use_is_high_velocity': True, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': True, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': False, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': True, 'use_txn_hour': False, 'use_txn_hour_sin': False, 'use_txn_hour_cos': True, 'use_day_of_week': False, 'use_days_since_last': True, 'use_unusual_hour_flag': False, 'use_time_diff': False, 'use_avg_txn_interval': True, 'use_zscore_amt': True, 'use_burst_small_txn': True, 'use_txn_amt_std': False, 'use_amt_7d_avg': False, 'use_total_spend': False, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': True, 'use_loc_anomalous': True, 'use_loc_mismatch': False, 'max_depth': 6, 'learning_rate': 0.040120576533287614, 'subsample': 0.6137174672832189, 'colsample_bytree': 0.9505218762751942, 'gamma': 0.2962411035872726, 'reg_alpha': 0.33692517835095226}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:14:13.791+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  70%|#######   | 14/20 [02:33<00:52,  8.74s/it]
[2025-07-04T03:14:13.796+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  70%|#######   | 14/20 [02:33<00:52,  8.74s/it]
[2025-07-04T03:14:13.797+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  75%|#######5  | 15/20 [02:33<00:55, 11.07s/it]
[2025-07-04T03:14:13.867+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:14:21.252+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:14:21.253+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:14:21.253+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:14:21,252] Trial 15 finished with value: 0.44970199498114805 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': False, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': False, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': False, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': True, 'max_depth': 7, 'learning_rate': 0.06872032802586717, 'subsample': 0.9441943807606894, 'colsample_bytree': 0.8629275351023336, 'gamma': 0.17536411171795624, 'reg_alpha': 0.1492843326916044}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:14:21.254+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  75%|#######5  | 15/20 [02:40<00:55, 11.07s/it]
[2025-07-04T03:14:21.259+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  75%|#######5  | 15/20 [02:40<00:55, 11.07s/it]
[2025-07-04T03:14:21.260+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  80%|########  | 16/20 [02:40<00:39,  9.98s/it]
[2025-07-04T03:14:21.331+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:14:28.585+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:14:28.585+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:14:28.586+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:14:28,584] Trial 16 finished with value: 0.4182922529110947 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': False, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': False, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': False, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': False, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': True, 'use_loc_anomalous': True, 'use_loc_mismatch': False, 'max_depth': 7, 'learning_rate': 0.026228743508017675, 'subsample': 0.9596358148525298, 'colsample_bytree': 0.8475315200402473, 'gamma': 0.10783968434298032, 'reg_alpha': 0.17003568340090044}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:14:28.587+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  80%|########  | 16/20 [02:48<00:39,  9.98s/it]
[2025-07-04T03:14:28.592+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  80%|########  | 16/20 [02:48<00:39,  9.98s/it]
[2025-07-04T03:14:28.592+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  85%|########5 | 17/20 [02:48<00:27,  9.19s/it]
[2025-07-04T03:14:28.679+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:14:40.691+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:14:40.692+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:14:40.693+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:14:40,691] Trial 17 finished with value: 0.45199270598660274 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': False, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': True, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': False, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': True, 'max_depth': 7, 'learning_rate': 0.046794474760816336, 'subsample': 0.9411983372435887, 'colsample_bytree': 0.8188424229219861, 'gamma': 0.19388179367129682, 'reg_alpha': 0.253455864569418}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:14:40.693+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  85%|########5 | 17/20 [03:00<00:27,  9.19s/it]
[2025-07-04T03:14:40.698+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  85%|########5 | 17/20 [03:00<00:27,  9.19s/it]
[2025-07-04T03:14:40.699+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  90%|######### | 18/20 [03:00<00:20, 10.06s/it]
[2025-07-04T03:14:40.782+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:14:54.288+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:14:54.289+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:14:54.290+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:14:54,288] Trial 18 finished with value: 0.4496458787276356 and parameters: {'use_amount': False, 'use_is_night': True, 'use_is_weekend': True, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': True, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': True, 'use_amt_vs_median': True, 'use_amt_change_ratio': True, 'use_spend_ratio_24h': True, 'use_txn_hour': True, 'use_txn_hour_sin': True, 'use_txn_hour_cos': False, 'use_day_of_week': False, 'use_days_since_last': False, 'use_unusual_hour_flag': False, 'use_time_diff': False, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': True, 'use_txn_amt_std': True, 'use_amt_7d_avg': True, 'use_total_spend': True, 'use_merchant_risk': False, 'use_merchant': False, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': True, 'use_loc_anomalous': False, 'use_loc_mismatch': True, 'max_depth': 6, 'learning_rate': 0.047707813870937345, 'subsample': 0.992068260830534, 'colsample_bytree': 0.7158879658471674, 'gamma': 0.207633196800464, 'reg_alpha': 0.26674907398929637}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:14:54.291+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  90%|######### | 18/20 [03:13<00:20, 10.06s/it]
[2025-07-04T03:14:54.295+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  90%|######### | 18/20 [03:13<00:20, 10.06s/it]
[2025-07-04T03:14:54.296+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  95%|#########5| 19/20 [03:13<00:11, 11.12s/it]
[2025-07-04T03:14:54.371+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/joblib/parallel.py:1379: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = self._backend.configure(

[2025-07-04T03:15:01.996+0000] {logging_mixin.py:190} WARNING -                                                                                     
[2025-07-04T03:15:01.997+0000] {logging_mixin.py:190} WARNING - 
[2025-07-04T03:15:01.998+0000] {logging_mixin.py:190} INFO - [I 2025-07-04 03:15:01,996] Trial 19 finished with value: 0.4218898170377067 and parameters: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': False, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': True, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': True, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': False, 'use_loc_anomalous': True, 'use_loc_mismatch': False, 'max_depth': 7, 'learning_rate': 0.031399657264210394, 'subsample': 0.8635354774761709, 'colsample_bytree': 0.8168064042698281, 'gamma': 0.2777802386429402, 'reg_alpha': 0.3875083333488928}. Best is trial 8 with value: 0.45252914866381144.
[2025-07-04T03:15:01.998+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  95%|#########5| 19/20 [03:21<00:11, 11.12s/it]
[2025-07-04T03:15:02.003+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529:  95%|#########5| 19/20 [03:21<00:11, 11.12s/it]
[2025-07-04T03:15:02.004+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529: 100%|##########| 20/20 [03:21<00:00, 10.10s/it]
[2025-07-04T03:15:02.004+0000] {logging_mixin.py:190} WARNING - Best trial: 8. Best value: 0.452529: 100%|##########| 20/20 [03:21<00:00, 10.08s/it]
[2025-07-04T03:15:02.007+0000] {fraud_detection_training.py:594} INFO - Best hyperparameters using Optuna: {'use_amount': True, 'use_is_night': False, 'use_is_weekend': True, 'use_transaction_day': True, 'use_amount_spent_last24h': False, 'use_prev_amount': True, 'use_user_activity_24h': True, 'use_txn_per_min': False, 'use_is_high_velocity': False, 'use_txn_count_5min': False, 'use_amt_to_avg_ratio': False, 'use_amt_to_avg_ratio_7d': False, 'use_amt_vs_median': False, 'use_amt_change_ratio': False, 'use_spend_ratio_24h': False, 'use_txn_hour': False, 'use_txn_hour_sin': True, 'use_txn_hour_cos': False, 'use_day_of_week': True, 'use_days_since_last': True, 'use_unusual_hour_flag': True, 'use_time_diff': False, 'use_avg_txn_interval': False, 'use_zscore_amt': False, 'use_burst_small_txn': False, 'use_txn_amt_std': True, 'use_amt_7d_avg': False, 'use_total_spend': True, 'use_merchant_risk': True, 'use_merchant': True, 'use_merchant_avg_fraud': False, 'use_merchant_txn_cnt': True, 'use_merchant_dist_24h': True, 'use_loc_anomalous': True, 'use_loc_mismatch': False, 'max_depth': 6, 'learning_rate': 0.05512734618003183, 'subsample': 0.9340936881905932, 'colsample_bytree': 0.934429833985923, 'gamma': 0.29479564384858875, 'reg_alpha': 0.3857938418193542}
[2025-07-04T03:15:02.964+0000] {logging_mixin.py:190} INFO - 🏃 View run auspicious-rat-635 at: http://mlflow-server:5500/#/experiments/1/runs/787ed487e554409c97e422dab405d864
[2025-07-04T03:15:02.965+0000] {logging_mixin.py:190} INFO - 🧪 View experiment at: http://mlflow-server:5500/#/experiments/1
[2025-07-04T03:15:03.014+0000] {fraud_detection_training.py:747} ERROR - Training failed: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"
Traceback (most recent call last):
  File "/opt/airflow/dags/fraud_detection_training.py", line 628, in train_model
    X_train_selected = X_train[best_features]
                       ~~~~~~~^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3899, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6115, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6179, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"
[2025-07-04T03:15:03.037+0000] {fraud_detection_training_dag.py:37} ERROR - Training failed: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"
Traceback (most recent call last):
  File "/opt/airflow/dags/fraud_detection_training_dag.py", line 32, in train_model
    model, precision = trainer.train_model()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/fraud_detection_training.py", line 628, in train_model
    X_train_selected = X_train[best_features]
                       ~~~~~~~^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3899, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6115, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6179, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"
[2025-07-04T03:15:03.059+0000] {taskinstance.py:3313} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/opt/airflow/dags/fraud_detection_training_dag.py", line 32, in train_model
    model, precision = trainer.train_model()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/fraud_detection_training.py", line 628, in train_model
    X_train_selected = X_train[best_features]
                       ~~~~~~~^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3899, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6115, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6179, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 763, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/fraud_detection_training_dag.py", line 38, in train_model
    raise AirflowException(f'Model training failed: {str(e)}')
airflow.exceptions.AirflowException: Model training failed: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"
[2025-07-04T03:15:03.073+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=fraud_detection_training, task_id=execute_training, run_id=scheduled__2025-07-03T03:00:00+00:00, execution_date=20250703T030000, start_date=20250704T030006, end_date=20250704T031503
[2025-07-04T03:15:03.108+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-07-04T03:15:03.109+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 13 for task execute_training (Model training failed: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"; 1328)
Traceback (most recent call last):
  File "/opt/airflow/dags/fraud_detection_training_dag.py", line 32, in train_model
    model, precision = trainer.train_model()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/fraud_detection_training.py", line 628, in train_model
    X_train_selected = X_train[best_features]
                       ~~~~~~~^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3899, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6115, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6179, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3006, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 274, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3161, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3185, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 763, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/fraud_detection_training_dag.py", line 38, in train_model
    raise AirflowException(f'Model training failed: {str(e)}')
airflow.exceptions.AirflowException: Model training failed: "['txn_hour_sin', 'day_of_week', 'days_since_last', 'unusual_hour_flag', 'txn_amt_std', 'total_spend', 'merchant_txn_cnt', 'merchant_dist_24h', 'loc_anomalous'] not in index"
[2025-07-04T03:15:03.204+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2025-07-04T03:15:03.243+0000] {taskinstance.py:3901} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-07-04T03:15:03.245+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
